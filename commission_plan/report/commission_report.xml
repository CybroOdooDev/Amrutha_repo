<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_commission">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">
                <t t-foreach="docs" t-as="o">
                    <div class="oe_structure">
                        <div class="col-12 mb-4">
                            <img t-if="o.company_id.logo"
                                 t-att-src="image_data_uri(o.company_id.logo)"
                                 style="max-height: 45px;" alt="Logo"/>
                            <div class="oe_structure"></div>
                        </div>
                        <h2>COMMISSION PAYOUT</h2>
                        <table class="table table-sm">
                            <tr>
                                <td>
                                    <strong>Date of Sale:</strong>
                                </td>
                                <td>
                                    <span t-field="o.create_date" t-field-options='{"format": "MM/dd/yyyy"}'/>
                                </td>
                            </tr>
                            <!-- Rest of the existing fields remain the same -->
                        </table>

                        <t t-if="o.company_id.is_calculate_commission">
                            <!-- Residential Commission Section -->
                            <h3>Commission to Lange Real Estate</h3>
                            <table class="table table-sm">
                                <tr>
                                    <td><strong>Amount:</strong></td>
                                    <td><span t-field="o.total_amount"/><span t-field="o.currency_id.symbol"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Due from Agent to meet minimum commission requirement:</strong></td>
                                    <td><span t-field="o.commission_to_be_converted_by_agent"/></td>
                                </tr>
                                <tr>
                                    <td><strong>External Referral Fee:</strong></td>
                                    <td><span t-field="o.referral_fee"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Total:</strong></td>
                                    <td>
                                        <span t-esc="o.total_amount + o.commission_to_be_converted_by_agent - o.referral_fee"/>
                                        <span t-field="o.currency_id.symbol"/>
                                    </td>
                                </tr>
                            </table>

                            <h3>Distributions to Agents</h3>
                            <table class="table table-sm">
                                <tr>
                                    <td><strong>Tier:</strong></td>
                                    <td><span t-field="o.tier"/>%</td>
                                </tr>
                                <tr>
                                    <td><strong>Commission Earned:</strong></td>
                                    <td><span t-field="o.total_commission"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Minimum Commission Due:</strong></td>
                                    <td><span t-field="o.minimum_commission_due"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Internal Referral Fee:</strong></td>
                                    <td><span t-field="o.referral_fee"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Transaction Coordinator Fee:</strong></td>
                                    <td>
                                        <t t-if="o.is_apply_transaction_coordinator_fee">
                                            <span t-field="o.company_id.tc_fee"/>
                                        </t>
                                        <t t-else="">
                                            <span>0.00</span>
                                        </t>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Payable to Agent:</strong></td>
                                    <td><span t-field="o.commission_to_be_paid"/></td>
                                </tr>
                            </table>
                        </t>
                        <t t-elif="o.company_id.is_calculate_commercial_commission">
                            <!-- Commercial Commission Section -->
                            <h3>Commission to Lange Real Estate</h3>
                            <table class="table table-sm">
                                <tr>
                                    <td><strong>Amount:</strong></td>
                                    <td><span t-field="o.planned_revenue"/><span t-field="o.currency_id.symbol"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Due from Agent to meet minimum commission requirement:</strong></td>
                                    <td><span t-field="o.commission_to_be_converted_by_agent"/></td>
                                </tr>
                                <tr>
                                    <td><strong>External Referral Fee:</strong></td>
                                    <td><span t-field="o.external_referral_fee"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Total:</strong></td>
                                    <td>
                                        <span t-esc="o.planned_revenue + o.commission_to_be_converted_by_agent - o.external_referral_fee"/>
                                        <span t-field="o.currency_id.symbol"/>
                                    </td>
                                </tr>
                            </table>

                            <h3>Distributions to Agents</h3>
                            <table class="table table-sm">
                                <tr>
                                    <td><strong>Tier:</strong></td>
                                    <td><span t-esc="o.agent_payout_tier * 100"/>%</td>
                                </tr>
                                <tr>
                                    <td><strong>Commission Earned:</strong></td>
                                    <td><span t-field="o.total_commercial_commission"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Minimum Commission Due:</strong></td>
                                    <td><span t-field="o.commission_to_be_converted_by_agent"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Internal Referral Fee:</strong></td>
                                    <td><span t-field="o.external_referral_fee"/></td>
                                </tr>
                                <tr>
                                    <td><strong>Transaction Coordinator Fee:</strong></td>
                                    <td><span>0.00</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Payable to Agent:</strong></td>
                                    <td><span t-field="o.total_commercial_commission_earned"/></td>
                                </tr>
                            </table>
                        </t>

                        <h3>Referral Fee Payable to Co-Agent</h3>
                        <p>
                            <strong>Payable to Agent 2:</strong>
                            <span t-field="o.referral_fee"/>
                        </p>

                        <p>All payments will be net of any outstanding charges
                            on agents' accounts.
                        </p>
                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>